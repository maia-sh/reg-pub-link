---
title             : "Results publications are inadequately linked to trial registrations: An automated pipeline and evaluation of German university medical centers"
shorttitle        : "Registration-publication links in German clinical trials"

author: 
  - name          : "Maia Salholz-Hillel\\orcidlink{0000-0003-1934-9504}"
    affiliation   : "1"
    corresponding : yes
    address       : "Anna-Louisa-Karsch-Str. 2, 10178, Berlin, Germany"
    email         : "maia.salholz-hillel@charite.de"
    role:         # CRediT roles (https://casrai.org/credit/)
      - Conceptualization
      - Methodology
      - Software
      - Investigation
      - Data Curation
      - Formal Analysis
      - Visualization
      - Validation
      - Project Administration
      - Writing - Original Draft Preparation
      - Writing - Review & Editing
  - name          : "Daniel Strech\\orcidlink{0000-0002-9153-079X}"
    affiliation   : "1"
    role:
      - Funding Acquisition
      - Resources
      - Conceptualization
      - Writing - Review & Editing
      - Supervision
  - name          : "Benjamin Gregory Carlisle\\orcidlink{0000-0001-8975-0649}"
    affiliation   : "1"
    role:
      - Writing - Review & Editing
      - Methodology
      - Software
      - Validation
      - Supervision

affiliation:
  - id            : "1"
    institution   : "QUEST Center for Responsible Research, Berlin Institute of Health (BIH) at Charité Universitätsmedizin Berlin"

authornote: >

abstract: |
  **Objective** To evaluate, using a novel automated approach, the links between registrations and results publications across a sample of clinical trials led by German university medical centers (UMCs) and registered in either ClinicalTrials.gov or the German Clinical Trials Registry (DRKS). The World Health Organization (WHO), the International Committee of Medical Journal Editors (ICMJE), and the Consolidated Standards of Reporting Trials (CONSORT) call for transparent registration-publication linking to make both clinical trial publications and registrations findable and thus increase the value of clinical research.
  
  **Design** Cross-sectional bibliographic study
  
  **Setting** German UMC clinical trials
  
  **Methods** We used automated strategies to download and extract data from trial registries, PubMed, and trial publications for a cohort of all registered, published clinical trials conducted across German UMCs and completed between 2009 and 2017. We implemented regular expressions to detect and classify publication identifiers (DOI and PMID) in registrations, and trial registrations numbers (TRNs) in publication metadata, abstract, and full-text. <!--# We verified our automated approach on a manually coded sample. -->
  
  **Main outcome measures** The proportion of trial registrations incorporating a structured reference (DOI or PMID) to a known results publication. The proportion of clinical trial results publications that reported the known TRN in the metadata, abstract, and full-text.
  
  **Secondary analyses** We constructed exploratory logistic regression models to investigate the relationship between trial completion date, registry, and registration-publication linking. <!--# We also looked at reported cross-registrations in the registries as well as additional TRNs reported in trial publications. -->
  
  **Results** Only `r knitr::load_cache(label = "abstract-vars", object = "abs_n_trials_link_full")` of trials comprehensively link their registrations and publications, meaning a linked publication (DOI or PMID) in the registration as well as the TRN in the publication full-text, abstract, and metadata. In contrast, `r knitr::load_cache(label = "abstract-vars", object = "abs_n_trials_link_none")` trials had no links. The most common link was TRN reported in the full-text, which occurred for `r knitr::load_cache(label = "abstract-vars", object = "abs_n_trials_link_trn_ft")` trials. ClinicalTrials.gov trials were overall better linked than DRKS trials, and this difference appears to be driven by PubMed and registry infrastructure, rather than by trialists. Of trials reporting a TRN in the abstract, ClinicalTrials.gov trials were more likely than DRKS trials to have the TRN captured in the PubMed metadata. Additionally, most (`r knitr::load_cache(label = "abstract-vars", object = "abs_n_trials_ctgov_link_reg_trn_si_derived")`) ClinicalTrials.gov registrations with a publication link were automatically indexed from PubMed metadata, which is not possible in DRKS.
  
  **Conclusion** German UMCs have not comprehensively linked trial registrations and publications by both including a structured reference to the publication in the registration, and reporting TRNs in results publications. In addition to improved linking by trialists, changes in the PubMed TRN capturing process (such as the incorporation of automated strategies like those used in this study) and automated indexing of publications in DRKS would make trial registrations and results more findable.
  
  **Open Data and Code** All code and the final analysis data for this study are available at https://github.com/maia-sh/reg-pub-link. Raw data (with the exception of the full-text of publications) is available at https://github.com/maia-sh/intovalue-data.<!--#TODO:move data processing into intovalue-data repo--><!--#**Registration** This study was not preregistered.  The study protocol is available at [insert link].-->
  
keywords          : "clinical trials, registration, reporting, meta-research"
wordcount         : "3714"

bibliography      : ["references.bib", "r-references.bib"]
# appendix          : "appendix.Rmd"

numbersections    : yes
floatsintext      : no
figurelist        : no
tablelist         : no
footnotelist      : no
linenumbers       : yes
mask              : no
draft             : no

lang              : "en-US"
documentclass     : "apa6"
classoption       : "man"
output            : papaja::apa6_word

header-includes   :
  - \usepackage{orcidlink}
---

```{r setup, include = FALSE}

knitr::opts_chunk$set(warning = FALSE, message = FALSE, echo = FALSE)
ggplot2::theme_set(ggplot2::theme_minimal())

library(dplyr)
library(tidyr)
library(stringr)
library(glue)
library(purrr)
library(here)
library(readr)

library(ggplot2)
library(DiagrammeR)
library(gtsummary)
library(gt)
library(papaja)

# Get data
trials_all <- read_rds(here("data", "processed", "trials.rds"))
pubmed_all <- read_rds(here("data", "processed", "pubmed-main.rds"))

# Prepare references
r_refs("r-references.bib")
r_citations <- 
  cite_r(file = "r-references.bib", footnote = TRUE) # pkgs, withhold #r_citations$r and r_citations$pkgs

# Source analyses
source(here("R", "functions", "screening.R"))
# # source(here("R", "functions", "report-results.R"))
source(here("R", "analysis", "01_screen-trials.R"))
# # source(here("R", "analysis", "02_flowchart-trials.R"))
source(here("R", "analysis", "03_tbl-trials.R"))
source(here("R", "analysis", "04_link-reg-pub.R"))
# # source(here("R", "analysis", "05_upset-link-reg-pub.R"))
source(here("R", "analysis", "06_plot-change-over-time.R"))
source(here("R", "analysis", "trn-regex-analysis.R"))
source(here("R", "analysis", "cross-registrations.R"))
source(here("R", "analysis", "logistic-regression.R"))
source(here("R", "analysis", "si-if-abs-ft.R"))
source(here("R", "analysis", "reg-auto-link.R"))
source(here("R", "analysis", "tbl-stakeholders.R"))
# # fs::dir_ls(here("R", "analysis")) %>% 
# #   purrr::walk(source)
```

```{r abstract-vars, cache = TRUE}
abs_n_trials_link_full <- report_pct_num_denom_trials(n_trials_link_full)
abs_n_trials_link_none <- report_n_pct_trials(n_trials_link_none)
abs_n_trials_link_trn_ft <- report_n_pct_trials(n_trials_link_trn_ft)

abs_n_trials_ctgov_link_reg_trn_si_derived <-
  inline_text(tbl_reg_pub_link_ctgov_auto_v_manual, reference_derived, column = "stat_1", pattern = "{p}%")
```

# Introduction

Clinical trial results risk being left out of evidence synthesis and health policy decision making if publications cannot be found. Incomplete evidence threatens healthcare and the lives and welfare of human volunteers. Legal regulations as well as ethical guidelines call for trial results transparency [@worldmedicalassociation2013; @worldhealthorganization2017; @altman2014gfrhraum; @borysowski2020bjcp]. Linking trial registrations and results publications makes each more findable, reducing the risk of information loss and increasing clinical research value [@kubben2019] <!--# looked for pub on FAIR/finable clinical trials and not finding much beyond just data-->. Furthermore, such threaded evidence empowers readers to cross-check sources, e.g., for potential outcome switching [@altman2014t], and can support systematic reviewers who rely on registrations to supply additional trial information for evidence synthesis [@miron2020sd].

Trial results should be bidirectionally linked, meaning the inclusion of both a structured reference to publications in the registration, and trial registration numbers (TRN) in the full-text, abstract, and metadata of publications. The Consolidated Standards of Reporting Trials (CONSORT) as well as the ICMJE's *Recommendations for the Conduct, Reporting, Editing, and Publication of Scholarly Work in Medical Journals* call for reporting "trial registration number and name of the trial register" in both the full-text and abstract of trial results publication [@internationalcommitteeofmedicaljournaleditorsicmje2019; @hopewell2008pm]. Reporting TRN solely in the full-text does not suffice since readers may not have access to the full-text or may base their judgment of the trial or topic on the abstract alone [@hopewell2008tl]. Abstracts may also be published independently of a full-text publication, such as for conference abstracts [@hopewell2008pm].

The inclusion of TRNs in publication and bibliographic metadata especially enhances machine readability and discoverability. Trial results can then be found more efficiently using TRNs to search publication databases [@huser2013po]. Publications can then also be automatically linked within trial registrations, as is currently done with ClinicalTrials.gov using TRN metadata from PubMed [@nationallibraryofmedicine2017c]. Such references to results publications within a registration allow readers to quickly identify and navigate to the trial findings. <!--# add policy background on why pub in reg --> Results references may also be entered manually in many registries, with varying degrees of structure. ClinicalTrials.gov, for example, provides fields for DOI and PubMed identifier (PMID), whereas DRKS offers an unstructured free-text field. <!--# add some background on ctgov vs. drks. and how they include trns and publications. and ctgov and pubmed by same nlm so may be better at seing those ids -->While readers of the registry may be able to find the referenced publication from the free-text, unique identifiers provide a more robust and structured link that allows for automated retrieval [@huser2013po].

Trial evidence appears to be insufficiently linked in both registries and publications. Previous studies on trial registrations found links to results publications in as few as 13% to as many as 42% of trials [@bashir2017sr; @huser2013po]. TRN reporting in either the metadata, abstract, or full-text of trial publications has been found to be as low at 8% and as high as 97%, varying widely depending on how the trial population was defined [@bashir2017sr; @carlisle2020m; @aldurra2020b]. For example, some studies included trial publications limited to specific journals or fields, whereas others relied on PubMed "clinical trial" publication type queries.

In order to draw robust conclusions about registration-publication linking, the analysis population must be limited to registered clinical trials with published results. Previous projects faced limitations due to the unclear publication cohort and unknown true registration rates. PubMed queries currently do not suffice to identify the true populations of clinical trials or even RCTs, both excluding true positives (i.e., sensitivity) and including false positives (i.e., specificity) [@glanville2020jmla]. Therefore not all PubMed-indexed clinical trials or RCTs should be registered <!--# as they may not reflect true clinical trials or RCTs -->, and not all that should be are. Furthermore, not all reported TRNs correspond to bona fide registrations of the trial whose results are reported in the publication, i.e., TRNs may be reported for related trials in the background section. As such, conclusions drawn by these previous studies relying on PubMed-query based samples, about registration reporting rates must be qualified as the rate of reported trial registration numbers in PubMed-indexed (randomized) clinical trials with unknown registration rates. <!--# remove previous sentence? --> Similarly, registry-based cohorts have included trials that may not have an associated publication and thus should not be expected to have a publication link. Furthermore, these studies of publication links in registrations have focused on ClinicalTrials.gov [@huser2013po; @huser2012; @goodwin2018], and we are not aware of previous studies investigating publication links in DRKS.

## Objectives

The exploratory study evaluates linking of registrations and results publications in a cross-section of published clinical trials led by German university medical centers (UMCs) and registered in either ClinicalTrials.gov or the German Clinical Trials Registry (DRKS) with completion dates between 2009 and 2017. We also looked at the relationship between different link types, as well as registry and change in practices over time.<!--# By relying on a cohort of known trial registrations and publications, we are able to draw conclusions about registration-publication links, both with regards to the rate of structured links to known results publications in its registration, and the rate of reporting a trial's known TRN in its publication full-text, abstract, and metadata.--> We developed an automated and scalable approach for data collection and extraction using regular expressions for the detection and classification of publication identifiers and TRNs, which may be applied to other trial cohorts. <!--# We did not pre-specify the analyses. We also explored the reporting of additional TRNs, beyond the known associated TRN, in publications, including reported cross-registrations, meaning more than one TRN in more than one registry associated with a single publication. We also looked at reporting PMC-version full-text. -->

# Methods

## Automated pipeline for data collection

We used two cohorts of registered clinical trials and associated results previously developed by @wieschowski2019joce and @riedel2021 and referred to as the "IntoValue" dataset. In brief, the dataset consists of clinical trials registered on ClinicalTrials.gov or the German Clinical Trials Registry (DRKS) and conducted at a German UMC completed between 2009 and 2017, and results publications found via manual searches [ADD DATASET REFERENCE].

We <!--# programmatically -->downloaded data from both registries on 15 May 2021. <!--# We fetched additional fields needed for our analysis, such as references, as well as refreshed the fields previously included in our source trial datasets to ensure parity between the two trial cohorts and current registry data. -->We queried ClinicalTrials.gov using the Clinical Trials Transformation Initiative (CTTI) Aggregate Content of ClinicalTrials.gov (AACT) via its PostgreSQL database API [@clinicaltrialstransformationinitiativectti]. As DRKS does not provide an API, we built a webscraper to capture the necessary fields [@federalinstitutefurdrugsandmedicaldevicesbfarm]. <!--# ClinicalTrials.gov requires more structured data input compared with DRKS; we attempted to tidy the DRKS output to extract additional information. For example, ClinicalTrials.gov has a separate summary results reporting section, whereas summary results are included with other references in DRKS. We inferred summary results based on common terminology (e.g., "study results", "Ergebnisbericht", "Abschlussbericht", "Studienergebnisse").-->

We queried the PubMed Entrez Programming Utilities (E-utilities) API<!--#on DAY MONTH YEEAR--> for all trial results PMIDs, and excluded PMIDs that did not resolve [@usnationallibraryofmedicinetigtand; @winter]. From the PubMed XML, we extracted bibliometric information, including the publication abstract and secondary identifier (or databank) metadata.<!--# , as well as MeSH terms, keywords, author details, and summary metadata -->

We used DOIs and PMIDs to search for full-text publications as PDFs, using a combination of automated and manual strategies, including contacting the corresponding author as a final step <!--# add that this was just for a few studies? -->[@ourresearch; @jahn]. We then used the GROBID machine learning library for technical and scientific publications (v0.6.1) via Python to parse the PDFs into machine-readable XMLs [@2008; @lopez2021]. In order to isolate the main body from the publication abstract for our analysis, we extracted the `<body>` sections of the papers.

Figure \@ref(fig:flow-methods) show the methods flow using automated techniques<!--# with the exception of some full-text PDFs -->.

```{r flow-methods, fig.cap = "Data collection sources and methods", out.width="50%"}
knitr::include_graphics(here("docs", "figures", "flow-methods.png"))
```

### Inclusion and exclusion criteria

After updating registry data, we reapplied the IntoValue exclusion criteria to exclude trials that were completed before 2009 or after 2017, were non-interventional, or did not meet the recruitment or study status inclusion criteria (see @wieschowski2019joce and @riedel2021 for further details on these criteria). We also excluded trials without a German UMC lead, as only one of the two IntoValue cohorts included trials not led by German UMCs. For duplicate trials (i.e., appearing in both IntoValue cohorts), we excluded the earlier record. We also excluded trials without results, and trials with results for which we could not find a PMID and full-text publication.

## Detection and classification of publication identifiers in registrations

As reference data is available in difference formats depending on the registry, we developed parallel approaches to extract publication identifiers for each. For ClinicalTrials.gov, we retrieved the reference type, citation, and PMID fields from AACT. We then used a regular expression (regex) to extract any DOIs from the citations; we did not search for PMIDs as these are captured in an AACT field. For DRKS, we scraped the reference type, citation, and URL, when available. We used regexes to extract any DOIs and PMIDs from the citation and URL. In the rare cases when conflicting DOIs or PMIDs were found in the citation vs. the URL, we manually reviewed to determine which was valid; if both were valid, we preferred the identifier provided in the citation. In addition, we determined whether a reference was manually or automatically indexed in the registry. DRKS allows only manually added references; for ClinicalTrials.gov, references of type "derived" were marked as automatically indexed. We then used DOIs and PMIDs to match the referenced publications to those in our trial dataset. We did not attempt to match publications without identifiers (i.e., publication title only).

## Detection and classification of trial registration numbers in publications

We developed <!--# and evaluated [or more methods details] -->regexes for the TRN patterns for all PubMed-indexed and ICTRP-network registries (see Appendix \@ref(tab:tbl-trn-regexes)) <!--# or move to osf protocol or remove from this paper and make separate citation  --> and used these to detect and classify TRNs in the PubMed secondary identifier metadata, abstract, and full-text. To gauge the sensitivity and specificity of these regexes, we visually inspected all PubMed secondary identifier metadata<!--# for true positives and true negatives-->. For each source, we first extracted all unique TRN patterns within a source. Our regex allowed for minor formatting errors in the TRN patterns (such as additional punctuation). We then cleaned the TRN patterns to remove these formatting errors, and then deduplicated the corrected TRNs to exclude duplicates within a source uncovered through the cleaning process. We also coalesced across sources to deduce a list of unique TRNs by publication along with the source(s) in which each was reported.

The output of this TRN extraction, cleaning, and deduplication included TRNs beyond those of the known registrations. These additional TRNs could be cross-registrations of the same trial or provided as background or discussion. For this study, we were interested in whether known registrations were reported in the publication and so filtered for reported TRNs matching the known registrations. <!--# change this if considering cross-reg -->

## Analysis

We generated descriptive statistics on trial and publication characteristics, overall and by registry. We calculated the number and proportion of trials linked via the publication (full-text, abstract, metadata) and the registration.<!--#with each type of link and different combination of links.--> To explore change over time, the relationships between types of links, and differences between registries, we ran exploratory logistic regressions for each link type, with all other link types as well as registry and completion year as explanatory variables. In particular, since PubMed metadata may be generated from the publication abstract or full-text, we examined the relationship between TRN reporting in either the abstract or full-text, and TRN inclusion in the metadata. Additionally, since ClinicalTrials.gov registrations automatically reference publications with the TRN in the PubMed metadata (whereas DRKS does not), we examined the proportion of automatically vs. manually linked publications in ClinicalTrials.gov. To explore registry differences for only manually linked references, we excluded automated links and calculated the number and proportion of trials with the publication linked in the registration. <!--#add automatic links to regression for pub in registry? in which case would need to recode NA as FALSE. To explore whether automated links explains registry differences in publication links in the registry...-->

## Software, code, and data

Data collection, preparation, and analysis was performed in `r r_citations$r`<!--#aside from parsing PDFs to XML in Python-->.<!--#Additional packages and libraries are specified in the methods.--> All code and the final analysis data for this study are available at <https://github.com/maia-sh/reg-pub-link>. Raw data (with the exception of the full-text of publications) is available at <https://github.com/maia-sh/intovalue-data>. `r r_citations$pkgs`

# Results

The IntoValue dataset includes all trials led by a German UMC that were registered on ClinicalTrials.gov or DRKS and completed between 2009 and 2017 (n = `r n_trials_iv`). After applying our exclusion criteria, our sample included `r n_trials_ft_pdf` trials with `r n_pubs_unique` unique results publications indexed in PubMed and available as full-text, as some publications include results from more than one trial. Figure \@ref(fig:flow-trials) details the trial and publication screening. Table \@ref(tab:tbl-trials) shows summary descriptive details of the trials with results publications by registry. <!--# QUESTION: what summary info about trials and publications? I also include a long version of demographic data in case we want to include any of these, ideally with collapsed categories, in Table @ref(tab:tbl-trials-full) -->

```{r flow-trials, fig.cap = "Trials and publications screening", out.width="50%", out.height="50%"}
knitr::include_graphics(here("docs", "figures", "flow-trials.png"))
```

```{r tbl-trials}
tbl_trials %>% 
  modify_caption("Characteristics of included trials with results publications")
  # gtsummary::as_flex_table() %>% 
  # flextable::set_caption(caption = "Characteristics of included trials with results publications")
```

While per our inclusion criteria all trials in our sample (n = `r n_trials_ft_pdf`) were registered and had a publication, only `r report_n_pct_trials(n_trials_link_full)` trials had the most comprehensive registration-publication linking, meaning a linked publication in the registration as well as the TRN in the publication full-text, abstract, and PubMed metadata. Disregarding metadata, which is largely beyond trialists' control, an additional `r n_trials_link_ft_abs_reg - n_trials_link_full` trials had comprehensive linking for a total of `r report_n_pct_trials(n_trials_link_ft_abs_reg)`. In contrast, we found `r report_n_pct_trials(n_trials_link_none)` trials with no links in either the registration or the publication. The most common linking practice was reporting of the TRN in the full-text only, accounting for `r report_n_pct_trials(n_trials_link_trn_ft_only)` trials. The inclusion of the various link types ranged from `r report_pct_num_denom_trials(n_trials_link_trn_abs)` in abstracts to `r report_pct_num_denom_trials(n_trials_link_trn_ft)` in full-text. Table \@ref(tab:tbl-link-by-reg) shows registration-publication links overall and by registry. <!--# point estimates in table should have CI, right? -->Figure \@ref(fig:plot-upset-links-reg-pub-registries) shows the intersection of registration-publication links across the various types for ClinicalTrial.gov and DRKS trials.<!--#shows the number of trials with each link type and combination of link types, overall and by registry.-->

```{r tbl-link-by-reg}
tbl_link_by_reg %>% 
  modify_caption("Registration-publication links by registry")
  # gtsummary::as_flex_table() %>% 
  # flextable::set_caption(caption = "Registration-publication links by registry")
```

```{r plot-upset-links-reg-pub-registries, fig.cap = "Registration-publication links in ClinicalTrials.gov and DRKS", out.width="80%"}
knitr::include_graphics(here("docs", "figures", "plot-upset-links-reg-pub-registry.png"))
```

```{r tbl-trials-regression}
tbl_trials_regression %>% 
  modify_caption("Crude and adjuusted odds ratios for factors associated with publication-registration links")
  # gtsummary::as_flex_table() %>% 
  # flextable::set_caption(caption = "Crude and adjuusted odds ratios for factors associated with publication-registration links")
```

Table \@ref(tab:tbl-trials-regression) shows the crude univariate and adjusted multivariate odds ratios (ORs) for each type of publication-registration link across all explanatory variables. Completion year did not have a strong relationship with linking practices, although trials completing more recently were more likely report the TRN in the abstract (`r inline_text(cor_abs, variable = "completion_year", pattern = "cOR {estimate} [{ci}]")`; `r inline_text(aor_abs, variable = "completion_year", pattern = "aOR {estimate} [{ci}]")`) and full-text (`r inline_text(cor_ft, variable = "completion_year", pattern = "cOR {estimate} [{ci}]")`; `r inline_text(aor_ft, variable = "completion_year", pattern = "aOR {estimate} [{ci}]")`). Figure \@ref(fig:plot-links-year-reg) shows the rate of registration-publication links over time for ClinicalTrials.gov and DRKS.

```{r plot-links-year-reg, fig.cap = "Change over time in registration-publication links in ClinicalTrials.gov and DRKS. Completion year from registry."}
knitr::include_graphics(here("docs", "figures", "plot-links-year-reg.png"))
```

Across the adjusted multivariate models,<!--#in the adjusted analysis,--> trials with one type of link were generally more likely to have another type of link. <!--#However, trials with a TRN in the full-text were significantly less likely to have the publication linked in the registration (`r inline_text(aor_reg, variable = "has_iv_trn_ft_pdf", pattern = "aOR {estimate} [{ci}]")` ; `r inline_text(aor_ft, variable = "has_reg_pub_link", pattern = "aOR {estimate} [{ci}]")`).--> In particular, TRNs were more likely to appear in the PubMed metadata if included in the abstract (`r inline_text(aor_si, variable = "has_iv_trn_abstract", pattern = "aOR {estimate} [{ci}]")`), but not more likely if included in the full-text (`r inline_text(aor_si, variable = "has_iv_trn_ft_pdf", pattern = "aOR {estimate} [{ci}]")`). Futhermore, DRKS TRNs were less likely than ClinicalTrials.gov TRNs to appear in the PubMed metadata (`r inline_text(aor_si, variable = "registry", level = "DRKS", pattern = "aOR {estimate} [{ci}]")`). Similarly, for trials with a TRN in either abstract or full-text, ClinicalTrials.gov TRNs appeared at a higher rate than DRKS TRNs in the metadata (`r inline_text(tbl_si_abs_or_ft, "has_iv_trn_secondary_id", column = "stat_1", pattern = "{p}%")` vs. `r inline_text(tbl_si_abs_or_ft, "has_iv_trn_secondary_id", column = "stat_2", pattern = "{p}%")`). Table \@ref(tab:tbl-si-if-abs-ft) shows the number and proportion of trials with a TRN in the metadata given a TRN in the abstract, full-text, or either, both overall and by registry.

```{r tbl-si-if-abs-ft}
tbl_si_if_abs_ft
```

DRKS trials were also less likely than ClinicalTrials.gov trials to reference the publication in the registration (`r inline_text(aor_reg, variable = "registry", level = "DRKS", pattern = "aOR {estimate} [{ci}]")`). <!--#Inclusion of the TRN in the abstract was significantly less likely in DRKS than ClinicalTrials.gov trials in the crude data (`r inline_text(cor_abs, variable = "registry", level = "DRKS", pattern = "cOR {estimate} [{ci}]")`), whereas more likely in the adjusted analysis (`r inline_text(aor_abs, variable = "registry", level = "DRKS", pattern = "aOR {estimate} [{ci}]")`).--> Most (`r inline_text(tbl_reg_pub_link_ctgov_auto_v_manual, reference_derived, column = "stat_1", pattern = "{p}%, {n}/{N}")`) ClinicalTrials.gov trials referencing the publication in the registration had the link automatically derived from the PubMed metadata, which is not currently possible for DRKS. Excluding trials with automatically linked publications, ClinicalTrials.gov and DRKS had similar rates of referencing publication in the registration (`r inline_text(tbl_reg_pub_link_manual, has_reg_pub_link, column = "stat_1", pattern = "{p}%, {n}/{N}")` vs. `r inline_text(tbl_reg_pub_link_manual, has_reg_pub_link, column = "stat_2", pattern = "{p}%, {n}/{N}")`).

## Evaluation of TRN regular expressions

<!--# TODO: add to methods if this is staying? -->

To gauge the sensitivity and specificity of the TRN regexes, we visually inspected all PubMed secondary identifiers extracted for our sample (n = `r nrow(si)`). PubMed's secondary identifier field can contain identifiers from not only clinical trial registries, but also other databanks, such as molecular sequences and open data repositories (i.e., figshare, Dryad) [@nationallibraryofmedicine2018]. Most ids were clear true positive TRNs (n = `r si_tp`) and a handful were clear true negative other ids (n = `r si_figshare`). We also found `r si_drks_misformatted` ids which we manually classified as true negative non-TRNs; however, using additional PubMed data, we determined these were severely misformatted DRKS ids (i.e., missing the preceding letters "DRKS" and just a string of numbers such as "00000711"). Our regexes correctly classified all well formatted TRNs and non-TRNs, resulting in a sensitivity and specificity of 100%. If we had instead categorized the `r si_drks_misformatted` severely misformatted DRKS ids as true positives, our regexes would have sensitivity of `r style_percent(si_sens_alt, digits = 1)`% and a specificity of `r style_percent(si_spec_alt)`%.


# Discussion

Linking of trial registrations and results publications plays an important role in research transparency and can substantially increase the value of this resource-intensive area of biomedical research. Poor linking poses a barrier to identifying trial publications via automated approaches and instead require researchers to perform intensive manual keyword-based searches to match publications to trials [@wieschowski2019joce; @chen2016b; @bashir2017sr]. This responsible practice comes at minimal costs to researchers, from seconds for pasting TRNs in papers, to minutes for adding a publication link to the registration.

Our study shows that German UMCs can improve in both TRN reporting in publications and references to publications in the registration. In our sample (n = `r n_trials_ft_pdf`), `r report_n_pct_trials(n_trials_link_none)` trials had no links between registration and publication and only `r report_n_pct_trials(n_trials_link_full)` trials had the most comprehensive registration-publication links. Furthermore, only `r report_n_pct_trials(n_trials_link_trn_ft_abs)` trials in our sample fully met the CONSORT and ICMJE guidelines to include TRNs in both the full-text and the abstract. Linking practices showed at best minimal improvement over time.  The upward trend in reporting in full-text and abstracts suggests this practice is gaining traction, however more slowly than advisable per CONSORT and ICMJE guidelines.<!--# shorten--> Trials registered in ClinicalTrials.gov were overall better linked than trials registered in DRKS.<!--# We found substantial differences between registries with ClinicalTrials.gov better linked than DRKS. --> These differences are in part beyond trialists' control and reliant on bibliometric databases (i.e., PubMed) and registries, namely (1) generating PubMed metadata from TRNs in the abstract or full-text, and (2) automated indexing of publications in the registry.

Our findings suggest that PubMed's current approach to capturing TRNs in metadata misses TRNs from the full-text as well as DRKS trials. TRNs in PubMed metadata may be either provided by publishers or manually assigned by National Library of Medicine (NLM) staff who copy-and-paste TRNs found in the abstract and full-text (personal communication via NLM Helpdesk Ticket CAS-552810-T3H7V5). As such, we expect a TRN from any registry to be included in the metadata, if the trialist includes it in either the abstract or the full-text. However, we found that while trials with a TRN in the abstract were indeed more likely to include the TRN in the metadata (`r inline_text(aor_si, variable = "has_iv_trn_abstract", pattern = "aOR {estimate} [{ci}]")`), TRNs in the full-text were not more likely to appear in the metadata (`r inline_text(aor_si, variable = "has_iv_trn_ft_pdf", pattern = "aOR {estimate} [{ci}]")`). Furthermore, our data suggest that NLM staff are better at extracting ClinicalTrials.gov than DRKS TRNs (`r inline_text(aor_si, variable = "registry", level = "DRKS", pattern = "aOR {estimate} [{ci}]")`).<!--# As such, it appears that PubMed metadata misses TRNs from the full-text as well as DRKS trials.-->

Automated indexing of publications in ClinicalTrials.gov accounts for most (`r inline_text(tbl_reg_pub_link_ctgov_auto_v_manual, reference_derived, column = "stat_1", pattern = "{p}%, {n}/{N}")`) publication references in the registry and drives the almost three-fold discrepancy with DRKS (`r inline_text(tbl_link_by_reg, has_reg_pub_link, "ClinicalTrials.gov", pattern = "{p}%, {n}/{N}")` vs. `r inline_text(tbl_link_by_reg, has_reg_pub_link, "DRKS", pattern = "{p}%, {n}/{N}")`).<!--# Excluding trials with automatically linked publications, ClinicalTrials.gov and DRKS had similar rates of referencing publication in the registration (`r inline_text(tbl_reg_pub_link_manual, has_reg_pub_link, column = "stat_1", pattern = "{p}%, {n}/{N}")`)--> Currently, DRKS allows only for manual submission of references by trialists and does not index publications.<!--# add?-->


Accurate TRN formatting in publication data is critical for machine-readability, which in turn enables automated indexing of publications in the registration. While our regular expressions allow for and correct minor formatting errors (such as erroneous punctuation), egregious misformatting may make the TRN undetectable. For example, in our visual inspection of the PubMed metadata TRNs, we found `r si_drks_misformatted` severely misformatted DRKS TRNS (i.e., numbers only with no preceding letters), which we could only identify as DRKS TRNs using additional metadata and which prevented the regex from classifying them as TRNs based on the pattern alone. <!--#Classifying these cases as true negative, our regexes correctly classified all TRNs and non-TRNs in our sample's the PubMed metadata secondary identifier field (sensitivity and specificity of 100%). remove since not about trn formatting alone? Futhermore, ClinicalTrials.gov presumably relies not only on the reported TRN but also on the registry, and as such failed to index a publication (PMID: 26417987) despite the TRN (NCT01614301) appearing in the PubMed metadata, as the associated databank was incorrect (i.e., GENBANK). -->

## Strengths and Limitations

This approach has numerous strengths. In contrast with previous studies relying on PubMed queries to identify potential (randomized) clinical trial results publications, we relied on a sample of bona fide results publications from registered trials, allowing us to evaluate the rate of structured links to known results publications in its registration, and the rate of reporting a trial's known TRN in its publication full-text, abstract, and metadata. Futhermore, we used an automated approach including regular expressions with high sensitivity and specificity to identify and classify publication identifiers and TRNs which allowed for a larger sample size that manual data extraction would have permitted. This automated strategy is scalable and can be applied to other trial sets.

The approach also faces limitations. Our input IntoValue dataset comprised German UMC-led trials in ClinicalTrials.gov and DRKS and may not reflect practices across other registries and/or countries. Future projects should look at multi-national samples of bona fide results publications. Furthermore, we relied on IntoValue for trial deduplication and bona fide results publications. The dataset may have had a small number of unaccounted for cross-registrations (e.g., DRKS00004156 and NCT00215683) and publications that are not trial results (e.g., systematic reviews, conference abstract books, etc.<!--# DRKS00009565 associated publication is 10.1097/aap.0000000000000573, a systematic review, with many reported TRNs-->). Finally, this automated approach faces limitations of the software on which it is built. While PubMed updated their website in 2020, their API reflects the previous backend and has subtle differences to the web version (personal communication via NLM Helpdesk Ticket CAS-575119-Y6D6Y4). While GROBID algorithms are trained on academic papers and have been used in large-scale bibliometric projects [e.g., @wang2020ac], parsing PDFs to XMLs may introduce some errors.<!--#Finally, the approach relies on quality input text data, and since journal articles are still most commonly distributed as PDFs, parsing errors may reduce text quality. We minimized this risk by relying on GROBID to parse full-text PDFs into XML with the body separated out from the abstract, header, and back. While GROBID algorithms are trained on academic papers and have been used in large-scale bibliometric projects [e.g., @wang2020ac], it does not perfectly classify the full-text main body. As such, TRNs appearing in the main body main be mistakenly excluded and TRNs appearing in the header or back material may be mistakenly included.-->


## Implications for policy and practice

This study reveals shortcomings in the linking of German UMC-led trials registrations and results publications and highlights several promising avenues forward. In contrast with other responsible clinical research practices (such as data protection or trial registration itself), registration-publication linking is relatively straightforward and can be improved with action across stakeholders. Drawing from the study findings and additional context, Table  \@ref(fig:tbl-stakeholders) outlines recommendations for stakeholders across clinical research.

```{r tbl-stakeholders}
# https://www.anthonyschmidt.co/post/2020-06-03-making-apa-tables-with-gt/
# results = "asis"
# tbl_stakeholders %>%
#   as_latex()
knitr::include_graphics(here::here("docs", "figures", "tbl-stakeholders.png"))
```

With improved TRN inclusion in bibliographic metadata and increased automatic indexing of publications based on this metadata, full linking could be achieved with negligible work by researchers: simply pasting the TRN into the publication abstract and full-text. In our sample alone, an additional `r report_pct_num_denom_trials(n_trials_link_trn_ft_or_abs_no_si, n_trials_link_trn_ft_or_abs)` of trials with TRN in abstract or full-text could have the TRN included in PubMed's metadata, and an additional `r report_pct_num_denom_trials(n_trials_drks_trn_si_not_linked_pub, n_trials_drks_trn_si)` of DRKS trials with TRN in the PubMed metadata could be automatically indexed in the registration. With the uptake of the recommended actions across stakeholder groups, improved trial registration-publication links will allow for more comprehensive evidence synthesis and increase the value of clinical research.

# Acknowledgments

We would like to thank Kerstin Rubarth from the Charité Institut für Biometrie und Klinische Epidemiologie for her consultation on the statistical analysis.

# Funding

This work was funded under a grant from the Federal Ministry of Education and Research of Germany (Bundesministerium für Bildung und Forschung - BMBF) [insert grant number]. The funder had no involvement in the study design, data collection, analysis, or interpretation, writing of the manuscript, or the decision to submit for publication.

# Author disclosures

MSH, BGC, and DS declare they have no direct conflict of interest related to this work. MSH is employed as a researcher under the project funding and additional grants from the German Bundesministerium für Bildung und Forschung (BMBF). DS is a member of the Sanofi Advisory Bioethics Committee and receives an honorarium for his contribution to meetings. <!--# BGC? -->

\newpage

# References

```{=tex}
\begingroup
\setlength{\parindent}{-0.5in}
\setlength{\leftskip}{0.5in}
```
::: {#refs custom-style="Bibliography"}
:::

\endgroup

# ```{r echo = FALSE, results = 'asis', cache = FALSE}
# papaja::render_appendix('appendix.Rmd')
# ```
